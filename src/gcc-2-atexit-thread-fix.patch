diff --git a/libstdc++-v3/libsupc++/atexit_thread.cc b/libstdc++-v3/libsupc++/atexit_thread.cc
index 000000000..111111111 100644
--- a/libstdc++-v3/libsupc++/atexit_thread.cc
+++ b/libstdc++-v3/libsupc++/atexit_thread.cc
@@ -95,7 +95,15 @@ namespace {
   void run (void *p)
   {
     auto elt = (__cxxabiv1::__cxa_thread_info*)p;
+#if defined(__MINGW32__) && !defined(_GLIBCXX_HAS_GTHREADS)
+    // Guard against invalid thread data during DLL unload with win32 threads
+    if (!elt || !elt->head)
+      return;
+#endif
     while (elt->head)
       {
+#if defined(__MINGW32__) && !defined(_GLIBCXX_HAS_GTHREADS)
+	if (!elt->head->func) break;
+#endif
 	struct elt_t *next = elt->head->next;
 	elt->head->func (elt->head->obj);
 	free (elt->head);
